<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.13" />
    <style>
      :root {
        --c-bg: #fff;
      }

      html.dark {
        --c-bg: #22272e;
      }

      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <link rel="icon" href="/laravel-purity/images/favicon.ico"><title>Docs | Laravel Purity</title><meta name="description" content="Filter and Sort Laravel Queries Elegantly">
    <link rel="preload" href="/laravel-purity/assets/style-CU2Kg4P2.css" as="style"><link rel="stylesheet" href="/laravel-purity/assets/style-CU2Kg4P2.css">
    <link rel="modulepreload" href="/laravel-purity/assets/app-BdO4TBkx.js"><link rel="modulepreload" href="/laravel-purity/assets/docs.html-D5BXwHme.js">
    <link rel="prefetch" href="/laravel-purity/assets/index.html-2cUMHk50.js" as="script"><link rel="prefetch" href="/laravel-purity/assets/404.html-DkaR_9N1.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon"><!--[--><header class="vp-navbar"><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/laravel-purity/"><img class="vp-site-logo" src="/laravel-purity/images/purity-logo.png" alt="Laravel Purity"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Laravel Purity</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/laravel-purity/" aria-label="Home"><!---->Home<!----></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/laravel-purity/docs.html" aria-label="Docs"><!---->Docs<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/abbasudo/laravel-purity" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!---->GitHub<!----></a></div><!--]--></nav><!--[--><!--]--><button class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar"><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/laravel-purity/" aria-label="Home"><!---->Home<!----></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/laravel-purity/docs.html" aria-label="Docs"><!---->Docs<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/abbasudo/laravel-purity" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!---->GitHub<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Docs <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#table-of-contents" aria-label="Table of Contents"><!---->Table of Contents<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#tutorials" aria-label="Tutorials"><!---->Tutorials<!----></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#video" aria-label="Video"><!---->Video<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#articles" aria-label="Articles"><!---->Articles<!----></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#installation" aria-label="Installation"><!---->Installation<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#basic-usage" aria-label="Basic Usage"><!---->Basic Usage<!----></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#filters" aria-label="Filters"><!---->Filters<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#sort" aria-label="Sort"><!---->Sort<!----></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#advanced-usage" aria-label="Advanced Usage"><!---->Advanced Usage<!----></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#allowed-fields" aria-label="Allowed Fields"><!---->Allowed Fields<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#rename-fields" aria-label="Rename Fields"><!---->Rename Fields<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#restrict-filters" aria-label="Restrict Filters"><!---->Restrict Filters<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#restrict-filters-by-field" aria-label="Restrict filters by field"><!---->Restrict filters by field<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#changing-params-source" aria-label="Changing Params Source"><!---->Changing Params Source<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#livewire" aria-label="Livewire"><!---->Livewire<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#custom-filters" aria-label="Custom Filters"><!---->Custom Filters<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#silent-exceptions" aria-label="Silent Exceptions"><!---->Silent Exceptions<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#sort-null-values-last" aria-label="Sort null values last"><!---->Sort null values last<!----></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#queries-and-javascript-examples" aria-label="Queries and javascript examples"><!---->Queries and javascript examples<!----></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#available-filters" aria-label="Available Filters"><!---->Available Filters<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#apply-sort" aria-label="Apply Sort"><!---->Apply Sort<!----></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="#upgrade-guide" aria-label="Upgrade Guide"><!---->Upgrade Guide<!----></a><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="#version-3" aria-label="Version 3"><!---->Version 3<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="#version-2" aria-label="Version 2"><!---->Version 2<!----></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><p align="center"><img src="https://github.com/abbasudo/laravel-purity/raw/master/art/purity-logo.png" alt="Social Card of Laravel Purity"><h1 align="center">Elegant way to filter and sort queries in Laravel</h1></p><p><a href="https://github.com/abbasudo/laravel-purity/actions/workflows/tests.yml" target="_blank" rel="noopener noreferrer"><img src="https://github.com/abbasudo/laravel-purity/actions/workflows/tests.yml/badge.svg" alt="Tests"></a><a href="https://github.com/abbasudo/laravel-purity" target="_blank" rel="noopener noreferrer"><img src="http://poser.pugx.org/abbasudo/laravel-purity/license" alt="License"></a><a href="https://packagist.org/packages/abbasudo/laravel-purity" target="_blank" rel="noopener noreferrer"><img src="http://poser.pugx.org/abbasudo/laravel-purity/v" alt="Latest Unstable Version"></a><a href="https://packagist.org/packages/abbasudo/laravel-purity" target="_blank" rel="noopener noreferrer"><img src="http://poser.pugx.org/abbasudo/laravel-purity/require/php" alt="PHP Version Require"></a><a href="https://packagist.org/packages/abbasudo/laravel-purity" target="_blank" rel="noopener noreferrer"><img src="https://github.styleci.io/repos/603931433/shield" alt="StyleCI"></a></p><blockquote><p><strong>Note</strong> If you are a front-end developer and want to make queries in an API that uses this package head to the <a href="#queries-and-javascript-examples">queries</a> section</p></blockquote><blockquote><p><strong>Note</strong> Version 3 changed <code>$filterFields</code> read more at <a href="#upgrade-guide">upgrade guide</a> section</p></blockquote><p>Laravel Purity is an elegant and efficient filtering and sorting package for Laravel, designed to simplify complex data filtering and sorting logic for eloquent queries. By simply adding <code>filter()</code> to your Eloquent query, you can add the ability for frontend users to apply filters based on URL query string parameters like a breeze.</p><p>Features :</p><ul><li>Livewire support (added in v2)</li><li>Rename and restrict fields (added in v2)</li><li>Various filter methods</li><li>Simple installation and usage</li><li>Filter by relation columns</li><li>Custom filters</li><li>Multi-column sort</li></ul><p>Laravel Purity is not only developer-friendly but also front-end developer-friendly. Frontend developers can effortlessly use filtering and sorting of the APIs by using the popular <a href="https://www.npmjs.com/package/qs" target="_blank" rel="noopener noreferrer">JavaScript qs</a> package.</p><p>The way this package handles filters is inspired by strapi&#39;s <a href="https://docs.strapi.io/dev-docs/api/rest/filters-locale-publication#filtering" target="_blank" rel="noopener noreferrer">filter</a> and <a href="https://docs.strapi.io/dev-docs/api/rest/sort-pagination#sorting" target="_blank" rel="noopener noreferrer">sort</a> functionality.</p><h2 id="table-of-contents" tabindex="-1"><a class="header-anchor" href="#table-of-contents"><span>Table of Contents</span></a></h2><nav class="table-of-contents"><ul><li><a aria-current="page" href="/laravel-purity/docs.html#table-of-contents" class="router-link-active router-link-exact-active">Table of Contents</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#tutorials" class="router-link-active router-link-exact-active">Tutorials</a><ul><li><a aria-current="page" href="/laravel-purity/docs.html#video" class="router-link-active router-link-exact-active">Video</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#articles" class="router-link-active router-link-exact-active">Articles</a></li></ul></li><li><a aria-current="page" href="/laravel-purity/docs.html#installation" class="router-link-active router-link-exact-active">Installation</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#basic-usage" class="router-link-active router-link-exact-active">Basic Usage</a><ul><li><a aria-current="page" href="/laravel-purity/docs.html#filters" class="router-link-active router-link-exact-active">Filters</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#sort" class="router-link-active router-link-exact-active">Sort</a></li></ul></li><li><a aria-current="page" href="/laravel-purity/docs.html#advanced-usage" class="router-link-active router-link-exact-active">Advanced Usage</a><ul><li><a aria-current="page" href="/laravel-purity/docs.html#allowed-fields" class="router-link-active router-link-exact-active">Allowed Fields</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#rename-fields" class="router-link-active router-link-exact-active">Rename Fields</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#restrict-filters" class="router-link-active router-link-exact-active">Restrict Filters</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#restrict-filters-by-field" class="router-link-active router-link-exact-active">Restrict filters by field</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#changing-params-source" class="router-link-active router-link-exact-active">Changing Params Source</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#livewire" class="router-link-active router-link-exact-active">Livewire</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#custom-filters" class="router-link-active router-link-exact-active">Custom Filters</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#silent-exceptions" class="router-link-active router-link-exact-active">Silent Exceptions</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#sort-null-values-last" class="router-link-active router-link-exact-active">Sort null values last</a></li></ul></li><li><a aria-current="page" href="/laravel-purity/docs.html#queries-and-javascript-examples" class="router-link-active router-link-exact-active">Queries and javascript examples</a><ul><li><a aria-current="page" href="/laravel-purity/docs.html#available-filters" class="router-link-active router-link-exact-active">Available Filters</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#apply-sort" class="router-link-active router-link-exact-active">Apply Sort</a></li></ul></li><li><a aria-current="page" href="/laravel-purity/docs.html#upgrade-guide" class="router-link-active router-link-exact-active">Upgrade Guide</a><ul><li><a aria-current="page" href="/laravel-purity/docs.html#version-3" class="router-link-active router-link-exact-active">Version 3</a></li><li><a aria-current="page" href="/laravel-purity/docs.html#version-2" class="router-link-active router-link-exact-active">Version 2</a></li></ul></li></ul></nav><h2 id="tutorials" tabindex="-1"><a class="header-anchor" href="#tutorials"><span>Tutorials</span></a></h2><h3 id="video" tabindex="-1"><a class="header-anchor" href="#video"><span>Video</span></a></h3><p><a href="https://youtu.be/nvCTEKvRdec" target="_blank" rel="noopener noreferrer"><img src="https://user-images.githubusercontent.com/86796762/227452155-3644f431-a8ce-41bc-ad4b-95383a3209fa.png" alt="youtube"></a></p><h3 id="articles" tabindex="-1"><a class="header-anchor" href="#articles"><span>Articles</span></a></h3><ul><li><a href="https://laravel-news.com/filter-api-responses-with-laravel-purity" target="_blank" rel="noopener noreferrer">Filter API Responses with Laravel Purity</a></li><li><a href="https://medium.com/@ahnabshahin/filter-and-sort-in-laravel-07bbb964f32d" target="_blank" rel="noopener noreferrer">Filter and Sort in Laravel</a></li><li><a href="https://dev.to/giuliano1993/mondev-newsletter-filter-better-with-laravel-purity-55c5" target="_blank" rel="noopener noreferrer">Filter better with Laravel Purity</a></li><li><a href="https://medium.com/@abbasudo/the-correct-way-of-adding-filters-to-laravel-10-bb9957c2ddc6" target="_blank" rel="noopener noreferrer">The correct way of adding filters to Laravel</a></li><li><a href="https://dev.to/abbasudo/add-filter-to-your-laravel-10-app-4f5f" target="_blank" rel="noopener noreferrer">Add filter to your laravel app</a></li><li><a href="https://medium.com/@abbasudo/enable-filtering-in-your-laravel-app-with-ease-a63f79b5e452" target="_blank" rel="noopener noreferrer">Enable filtering queries in your laravel 10 app with ease</a></li></ul><h2 id="installation" tabindex="-1"><a class="header-anchor" href="#installation"><span>Installation</span></a></h2><p>Install the package via composer by this command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">composer</span> require abbasudo/laravel-purity </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Get configs (<code>configs/purity.php</code>) file to customize the package&#39;s behavior by this command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">php artisan vendor:publish <span class="token parameter variable">--tag</span><span class="token operator">=</span>purity </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="basic-usage" tabindex="-1"><a class="header-anchor" href="#basic-usage"><span>Basic Usage</span></a></h2><h3 id="filters" tabindex="-1"><a class="header-anchor" href="#filters"><span>Filters</span></a></h3><p>Add <code>Filterable</code> trait to your model to get filters functionalities.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token keyword">use</span> <span class="token package">Abbasudo<span class="token punctuation">\</span>Purity<span class="token punctuation">\</span>Traits<span class="token punctuation">\</span>Filterable</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Post</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">use</span> <span class="token package">Filterable</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">//</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now add <code>filter()</code> to your model eloquent query in the controller.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name-definition class-name">PostController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>By default, it gives access to all filters available. here is the list of <a href="#available-filters">available filters</a>. if you want to explicitly specify which filters to use in this call head to <a href="#restrict-filters">restrict filters</a> section.</p><h3 id="sort" tabindex="-1"><a class="header-anchor" href="#sort"><span>Sort</span></a></h3><h4 id="sort-basics" tabindex="-1"><a class="header-anchor" href="#sort-basics"><span>Sort Basics</span></a></h4><p>Add <code>Sortable</code> trait to your model to get sorts functionalities.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token keyword">use</span> <span class="token package">Abbasudo<span class="token punctuation">\</span>Purity<span class="token punctuation">\</span>Traits<span class="token punctuation">\</span>Sortable</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Post</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">use</span> <span class="token package">Sortable</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">//</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now add <code>sort()</code> to your eloquent query in the controller.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name-definition class-name">PostController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now sort can be applied as instructed in <a href="#apply-sort">apply sort</a>.</p><h2 id="advanced-usage" tabindex="-1"><a class="header-anchor" href="#advanced-usage"><span>Advanced Usage</span></a></h2><h3 id="allowed-fields" tabindex="-1"><a class="header-anchor" href="#allowed-fields"><span>Allowed Fields</span></a></h3><p>By default, purity allows every database column and all model relations (that have a defined return type) to be filtered.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token comment">// App\Models\User</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">posts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name class-name-fully-qualified return-type">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Relations<span class="token punctuation">\</span>HasMany</span> <span class="token comment">// This is mandatory</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">hasMany</span><span class="token punctuation">(</span><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>you can overwrite the allowed columns as follows:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token comment">// App\Models\User</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">protected</span> <span class="token variable">$filterFields</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;email&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;mobile&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;posts&#39;</span><span class="token punctuation">,</span> <span class="token comment">// relation</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line"><span class="token keyword">protected</span> <span class="token variable">$sortFields</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;name&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;mobile&#39;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>any field other than email, mobile, or posts will be rejected when filtering.</p><h4 id="overwrite-allowed-fields" tabindex="-1"><a class="header-anchor" href="#overwrite-allowed-fields"><span>Overwrite Allowed Fields</span></a></h4><p>to overwrite allowed fields in the controller add <code>filterFields</code> or <code>sortFields</code> before calling filter or sort method.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">filterFields</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;title&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;created_at&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">sortFields</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;created_at&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;updated_at&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>Note</strong> filterFields and sortFields will overwrite fields defined in the model.</p></blockquote><h3 id="rename-fields" tabindex="-1"><a class="header-anchor" href="#rename-fields"><span>Rename Fields</span></a></h3><h4 id="rename-filter-fields" tabindex="-1"><a class="header-anchor" href="#rename-filter-fields"><span>Rename Filter Fields</span></a></h4><p>To rename filter fields simply add a value to fields defined in <code>$renamedFilterFields</code>.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token comment">// App\Models\User</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// ?filter[phone][$eq]=0000000000</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">protected</span> <span class="token variable">$renamedFilterFields</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;mobile&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;phone&#39;</span><span class="token punctuation">,</span> <span class="token comment">// Actual database column is mobile</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;posts&#39;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;writing&#39;</span><span class="token punctuation">,</span> <span class="token comment">// actual relation is posts</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The client should send phone in order to filter by mobile column in database.</p><h4 id="rename-sort-fields" tabindex="-1"><a class="header-anchor" href="#rename-sort-fields"><span>Rename Sort Fields</span></a></h4><p>To rename sort fields simply add a value to defined in <code>$sortFields</code></p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token comment">// App\Models\User</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// ?sort=phone</span></span>
<span class="line"><span class="token keyword">protected</span> <span class="token variable">$sortFields</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;name&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;mobile&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;phone&#39;</span><span class="token punctuation">,</span> <span class="token comment">// Actual database column is mobile</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The client should send phone in order to sort by mobile column in database.</p><h4 id="overwrite-renamed-fields" tabindex="-1"><a class="header-anchor" href="#overwrite-renamed-fields"><span>Overwrite Renamed Fields</span></a></h4><p>To overwrite renamed fields in the controller you pass renamed fields to <code>rebamedFilterFields</code> and <code>sortFields</code>.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">renamedFilterFields</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;created_at&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;published_date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">sortFields</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;created_at&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;published_date&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;updated_at&#39;</span></span>
<span class="line">  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>Note</strong> SortFields will overwrite fields defined in the model.</p></blockquote><h3 id="restrict-filters" tabindex="-1"><a class="header-anchor" href="#restrict-filters"><span>Restrict Filters</span></a></h3><p>purity validates allowed filters in the following order of priority:</p><ul><li>Filters specified in the <code>filters</code> configuration in the <code>configs/purity.php</code> file.</li></ul><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token comment">// configs/purity.php</span></span>
<span class="line"><span class="token string single-quoted-string">&#39;filters&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token class-name static-context">EqualFilter</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token class-name static-context">InFilter</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Filters declared in the <code>$filters</code> variable in the model.</li></ul><p>note that, $filters will overwrite configs filters.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token comment">// App\Models\Post</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword type-declaration">array</span> <span class="token variable">$filters</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;$eq&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;$in&#39;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line"><span class="token comment">// or</span></span>
<span class="line">    </span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword type-declaration">array</span> <span class="token variable">$filters</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token class-name static-context">EqualFilter</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token class-name static-context">InFilter</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Filters passed as an array to the <code>filterBy()</code> function.</li></ul><p>note that, <code>filterBy</code> will overwrite all other defined filters.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">filterBy</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;$eq&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;$in&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// or</span></span>
<span class="line"><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">filterBy</span><span class="token punctuation">(</span><span class="token class-name static-context">EqualFilter</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name static-context">InFilter</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="restrict-filters-by-field" tabindex="-1"><a class="header-anchor" href="#restrict-filters-by-field"><span>Restrict filters by field</span></a></h3><p>There are three available options for your convenience. They take priority respectively.</p><ul><li><strong>Option 1 : Define restricted filters inside <code>$filterFields</code> property, as shown below</strong></li></ul><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token variable">$filterFields</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;$eq&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// title will be limited to the eq operator</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;$eq&#39;</span><span class="token punctuation">,</span>    <span class="token comment">// works only for one restricted operator</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;title:$eq&#39;</span><span class="token punctuation">,</span>         <span class="token comment">// same as above</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;title&#39;</span><span class="token punctuation">,</span>             <span class="token comment">// this won&#39;t be restricted to any operator</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The drawback here is that you have to define all the allowed fields, regardless of any restrictions fields.</p><ul><li><strong>Option 2 : Define them inside <code>$restrictedFilters</code> property</strong></li></ul><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token variable">$restrictedFields</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;$eq&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;$eq&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// title will be limited to the eq operator</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;title:$eq,$in&#39;</span>             <span class="token comment">// same as above</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;title&#39;</span>                     <span class="token comment">// this won&#39;t be restricted to any operator</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>Option 3 : Finally, you can set it on the Eloquent builder, which takes the highest priority (overwrite all the above options)</strong></li></ul><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">restrictedFilters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;$eq&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Note</strong></p><blockquote><p>All field-restricted filter operations are respected to filters defined in $filter (<a href="#restrict-filters">here</a>). This means you are not allowed to restrict a field operation that is not permitted in restricted fields.</p></blockquote><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token variable">$filters</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;$eq&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$restrictedFilters</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;$eqc&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">// This won&#39;t work</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="sort-by-relationships" tabindex="-1"><a class="header-anchor" href="#sort-by-relationships"><span>Sort by Relationships</span></a></h4><p>The following relationship types are supported.</p><ul><li>One to One</li><li>One to Many</li><li>Many to Many</li></ul><p>Return type of the relationship mandatory as below in order to sort by relationships.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Relations<span class="token punctuation">\</span>HasMany</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Post</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">use</span> <span class="token package">Sortable</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">tags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">HasMany</span> <span class="token comment">// This is mandatory</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">hasMany</span><span class="token punctuation">(</span><span class="token class-name static-context">Tag</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="changing-params-source" tabindex="-1"><a class="header-anchor" href="#changing-params-source"><span>Changing Params Source</span></a></h3><p>By Default, purity gets params from filters index in query params, overwrite this by passing params directly to filter or sort functions:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">            <span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;$eq&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;good post&#39;</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">            <span class="token string single-quoted-string">&#39;title&#39;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string single-quoted-string">&#39;id:desc&#39;</span></span>
<span class="line">        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="livewire" tabindex="-1"><a class="header-anchor" href="#livewire"><span>Livewire</span></a></h3><p>to add filter to your livewire app, first define <code>$filters</code> variable in your component and pass it to filter or sort method:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token comment">// component</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute"><span class="token delimiter punctuation">#[</span><span class="token attribute-content"><span class="token attribute-class-name class-name">Url</span></span><span class="token delimiter punctuation">]</span></span></span>
<span class="line"><span class="token keyword">public</span> <span class="token variable">$filters</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token variable">$transactions</span> <span class="token operator">=</span> <span class="token class-name static-context">Transaction</span><span class="token operator">::</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">filters</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;livewire.transaction-table&#39;</span><span class="token punctuation">,</span><span class="token function">compact</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;transactions&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>then bind the variable in your blade template.</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre class="language-html"><code><span class="line"><span class="token comment">&lt;!-- in blade template --&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wire:</span>model.live</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>filters.title.$eq<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>read more in <a href="https://livewire.laravel.com/docs/url" target="_blank" rel="noopener noreferrer">livewire docs</a></p><h3 id="custom-filters" tabindex="-1"><a class="header-anchor" href="#custom-filters"><span>Custom Filters</span></a></h3><p>Create a custom filter class by this command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">php artisan make:filter EqualFilter</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>this will generate a filter class in <code>Filters</code> directory. By default, all classes defined in <code>Filters</code> directory are loaded into the package. you can change scan folder location in purity config file.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token comment">// configs/purity.php</span></span>
<span class="line"></span>
<span class="line"><span class="token string single-quoted-string">&#39;custom_filters_location&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">app_path</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Filters&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="silent-exceptions" tabindex="-1"><a class="header-anchor" href="#silent-exceptions"><span>Silent Exceptions</span></a></h3><p>By default, purity silences its own exceptions. to change that behavior change the <code>silent</code> index to <code>false</code> in the config file.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token comment">// configs/purity.php</span></span>
<span class="line"></span>
<span class="line"><span class="token string single-quoted-string">&#39;silent&#39;</span> <span class="token operator">=&gt;</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sort-null-values-last" tabindex="-1"><a class="header-anchor" href="#sort-null-values-last"><span>Sort null values last</span></a></h3><p>When sorting a column that contains null values, it&#39;s typically preferred to have those values appear last, regardless of the sorting direction. You can enable this feature in the configuration as follows:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre class="language-php"><code><span class="line"><span class="token comment">// configs/purity.php</span></span>
<span class="line"></span>
<span class="line">null_last <span class="token operator">=&gt;</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="queries-and-javascript-examples" tabindex="-1"><a class="header-anchor" href="#queries-and-javascript-examples"><span>Queries and javascript examples</span></a></h2><p>This section is a guide for front-end developers who want to use an API that uses Laravel Purity.</p><h3 id="available-filters" tabindex="-1"><a class="header-anchor" href="#available-filters"><span>Available Filters</span></a></h3><p>Queries can accept a filters parameter with the following syntax:</p><p><code>GET /api/posts?filters[field][operator]=value</code></p><p><strong>By Default</strong> the following operators are available:</p><table><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td><code>$eq</code></td><td>Equal</td></tr><tr><td><code>$eqc</code></td><td>Equal (case-sensitive)</td></tr><tr><td><code>$ne</code></td><td>Not equal</td></tr><tr><td><code>$lt</code></td><td>Less than</td></tr><tr><td><code>$lte</code></td><td>Less than or equal to</td></tr><tr><td><code>$gt</code></td><td>Greater than</td></tr><tr><td><code>$gte</code></td><td>Greater than or equal to</td></tr><tr><td><code>$in</code></td><td>Included in an array</td></tr><tr><td><code>$notIn</code></td><td>Not included in an array</td></tr><tr><td><code>$contains</code></td><td>Contains</td></tr><tr><td><code>$notContains</code></td><td>Does not contain</td></tr><tr><td><code>$containsc</code></td><td>Contains (case-sensitive)</td></tr><tr><td><code>$notContainsc</code></td><td>Does not contain (case-sensitive)</td></tr><tr><td><code>$null</code></td><td>Is null</td></tr><tr><td><code>$notNull</code></td><td>Is not null</td></tr><tr><td><code>$between</code></td><td>Is between</td></tr><tr><td><code>$notBetween</code></td><td>Is not between</td></tr><tr><td><code>$startsWith</code></td><td>Starts with</td></tr><tr><td><code>$startsWithc</code></td><td>Starts with (case-sensitive)</td></tr><tr><td><code>$endsWith</code></td><td>Ends with</td></tr><tr><td><code>$endsWithc</code></td><td>Ends with (case-sensitive)</td></tr><tr><td><code>$or</code></td><td>Joins the filters in an &quot;or&quot; expression</td></tr><tr><td><code>$and</code></td><td>Joins the filters in an &quot;and&quot; expression</td></tr></tbody></table><h4 id="simple-filtering" tabindex="-1"><a class="header-anchor" href="#simple-filtering"><span>Simple Filtering</span></a></h4><blockquote><p><strong>Tip</strong> In javascript use <a href="https://www.npmjs.com/package/qs" target="_blank" rel="noopener noreferrer">qs</a> directly to generate complex queries instead of creating them manually. Examples in this documentation showcase how you can use <code>qs</code>.</p></blockquote><p>Find users having &#39;John&#39; as their first name</p><p><code>GET /api/users?filters[name][$eq]=John</code></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;qs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> query <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line"><span class="token literal-property property">filters</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">$eq</span><span class="token operator">:</span> <span class="token string">&#39;John&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token literal-property property">encodeValuesOnly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// prettify URL</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/users?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Find multiple restaurants with ids 3, 6, 8</p><p><code>GET /api/restaurants?filters[id][$in][0]=3&amp;filters[id][$in][1]=6&amp;filters[id][$in][2]=8</code></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;qs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> query <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line"><span class="token literal-property property">filters</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token literal-property property">encodeValuesOnly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// prettify URL</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/restaurants?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="complex-filtering" tabindex="-1"><a class="header-anchor" href="#complex-filtering"><span>Complex Filtering</span></a></h4><p>Complex filtering is combining multiple filters using advanced methods such as combining <code>$and</code> &amp; <code>$or</code>. This allows for more flexibility to request exactly the data needed.</p><p>Find books with 2 possible dates and a specific author.</p><p><code>GET /api/books?filters[$or][0][date][$eq]=2020-01-01&amp;filters[$or][1][date][$eq]=2020-01-02&amp;filters[author][name][$eq]=Kai%20doe</code></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;qs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> query <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">filters</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">$or</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token literal-property property">$eq</span><span class="token operator">:</span> <span class="token string">&#39;2020-01-01&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token literal-property property">$eq</span><span class="token operator">:</span> <span class="token string">&#39;2020-01-02&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">author</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">$eq</span><span class="token operator">:</span> <span class="token string">&#39;Kai doe&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">encodeValuesOnly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// prettify URL</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/books?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="deep-filtering" tabindex="-1"><a class="header-anchor" href="#deep-filtering"><span>Deep Filtering</span></a></h4><p>Deep filtering is filtering on a relation&#39;s fields.</p><p>Find restaurants owned by a chef who belongs to a 5-star restaurant</p><p><code>GET /api/restaurants?filters[chef][restaurants][stars][$eq]=5</code></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;qs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> query <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">filters</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">chef</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">restaurants</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">stars</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token literal-property property">$eq</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">encodeValuesOnly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// prettify URL</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/restaurants?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="apply-sort" tabindex="-1"><a class="header-anchor" href="#apply-sort"><span>Apply Sort</span></a></h3><h4 id="apply-basic-sorting" tabindex="-1"><a class="header-anchor" href="#apply-basic-sorting"><span>Apply Basic Sorting</span></a></h4><p>Queries can accept a sort parameter that allows sorting on one or multiple fields with the following syntax&#39;s:</p><p><code>GET /api/:pluralApiId?sort=value</code> to sort on 1 field</p><p><code>GET /api/:pluralApiId?sort[0]=value1&amp;sort[1]=value2</code> to sort on multiple fields (e.g. on 2 fields)</p><p>The sorting order can be defined as:</p><ul><li><code>:asc</code> for ascending order (default order, can be omitted)</li><li><code>:desc</code> for descending order.</li></ul><p><em>Usage Examples</em></p><p>Sort using 2 fields</p><p><code>GET /api/articles?sort[0]=title&amp;sort[1]=slug</code></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;qs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> query <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;title&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;slug&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">encodeValuesOnly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// prettify URL</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/articles?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Sort using 2 fields and set the order</p><p><code>GET /api/articles?sort[0]=title%3Aasc&amp;sort[1]=slug%3Adesc</code></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;qs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> query <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;title:asc&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;slug:desc&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">encodeValuesOnly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// prettify URL</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/articles?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="apply-sort-by-relationships" tabindex="-1"><a class="header-anchor" href="#apply-sort-by-relationships"><span>Apply Sort by Relationships</span></a></h4><p>All the usages of basic sorting are applicable. Use dot(.) notation to apply relationship in the following format.</p><p><code>?sort=[relationship name].[relationship column]:[sort direction]</code></p><p><em>Usage Examples</em></p><p>The query below sorts posts by their tag name in ascending order (default sort direction). Direction is not mandatory when sorted by ascending order.</p><p><code>GET /api/posts?sort=tags.name:asc</code></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;qs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> query <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;tags.name:asc&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">encodeValuesOnly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// prettify URL</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/posts?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>[!Note] Sorting by nested relationships is not supported by the package as of now.</p></blockquote><h2 id="upgrade-guide" tabindex="-1"><a class="header-anchor" href="#upgrade-guide"><span>Upgrade Guide</span></a></h2><h3 id="version-3" tabindex="-1"><a class="header-anchor" href="#version-3"><span>Version 3</span></a></h3><p>changed how <code>$filterFields</code> array works. it no longer renames fields, instead, it restricts filters that are accepted by the field as mentioned in the <a href="#restrict-filters">Restrict filters</a> section. to rename fields refer to <a href="#rename-fields">Rename fields</a>. <code>sortFields</code> However, didnt change.</p><h3 id="version-2" tabindex="-1"><a class="header-anchor" href="#version-2"><span>Version 2</span></a></h3><p>changed filter function arguments. filter function no longer accepts filter methods, instead, filter function now accepts filter source as mentioned in <a href="#custom-filters">Custom Filters</a> section. to specify allowed filter methods use filterBy as mentioned in <a href="#restrict-filters">Restrict Filters</a></p></div><!--[--><!--]--></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link label" href="https://github.com/abbasudo/laravel-purity/edit/main/docs/docs.md" aria-label="Edit this page" rel="noopener noreferrer" target="_blank"><!--[--><svg class="edit-icon" viewbox="0 0 1024 1024"><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->Edit this page<!----></a></div><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: amkhzomi@gmail.com">Abbas mkhzomi</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/laravel-purity/assets/app-BdO4TBkx.js" defer></script>
  </body>
</html>
